
part1: https://sqlfiddle.com/sqlite/online-compiler?id=ffad9eff-70f1-45bf-a728-b49817cfbbae

part2: https://sqlfiddle.com/sqlite/online-compiler?id=35786e26-fd7b-4dd9-b30d-5cc2c8386f5d